webpackJsonp([4],{"+Kzv":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("bvGF"),i={mounted:function(){this.getDataSource()},data:function(){var e=function(e,t,a){/[`~!@#$%^&*()+= <>?"{},.\\/;'[\]]/im.test(t)||/[·！#￥（——）：；“”‘、，…… |《。》？、【】[\]]/im.test(t)?a(new Error("名称只能包含数字、中文、字母、下划线、短横线、冒号！")):/^[a-zA-Z\u4e00-\u9fa5]{1}/.test(t)?t.length>100?a(new Error("名称长度范围0-100")):a():a(new Error("名称必须以汉字或字母开头"))};return{name:"",tableData:[],allPage:1,currentPage:1,pageSize:10,dialogTableVisible:!1,dialogTableVisible2:!1,loading:!1,itemTable:[],dataSourceForm:{type:"1",address:"",name:""},rules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{validator:e,trigger:"blur"}],address:[{required:!0,message:"请输入地址",trigger:"blur"}]},tableForm:{name:"",comments:""},tableRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{validator:e,trigger:"blur"}]},dialogTableVisible3:!1,currentRowId:""}},methods:{getDataSource:function(){var e=this;this.loading=!0,Object(l.f)(this.currentPage,this.pageSize,"").then(function(t){e.tableData=t.data.list,e.allPage=t.data.total,e.loading=!1})},tabPage:function(e){this.currentPage=e,this.getDataSource()},onSubmit:function(){var e=this;this.$refs.dataSourceForm.validate(function(t){if(!t)return!1;Object(l.b)(e.dataSourceForm).then(function(){e.$message({message:"新增数据源成功",type:"success"}),e.dialogTableVisible=!1,e.getDataSource(),e.dataSourceForm={type:"1",address:"",name:""}})})},getDetails:function(e){var t=this;Object(l.e)(e.id).then(function(e){t.itemTable=e.data.items,t.dialogTableVisible2=!0})},addTableName:function(e){this.currentRowId=e.id,this.dialogTableVisible3=!0},addNewTable:function(){var e=this;this.$refs.tableForm.validate(function(t){if(!t)return!1;Object(l.a)(e.tableForm.name,e.currentRowId,e.tableForm.comments).then(function(){e.$message({message:"新增数据表成功",type:"success"}),e.dialogTableVisible3=!1,e.tableForm={name:"",comments:""}})})},deleteRow:function(e){var t=this;this.$confirm("确认删除?","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.d)(e.id).then(function(){t.$message({message:"删除数据源成功",type:"success"}),t.getDataSource()})}).catch(function(){})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"data-source-wrap"},[a("div",{staticClass:"data-source-main"},[a("div",{staticClass:"data-source-title"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.dialogTableVisible=!0}}},[e._v("新增数据源")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"data-source-table",staticStyle:{width:"100%","margin-top":"25px","border-left":"1px solid #e5e4e4"},attrs:{data:e.tableData,stripe:"",height:"calc(100vh - 415px)"}},[a("el-table-column",{attrs:{prop:"name",label:"名称",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"数据源类型",width:"250",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.type?a("p",[e._v("HBase")]):e._e(),e._v(" "),2===t.row.type?a("p",[e._v("MBTiles")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:"地址",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",align:"center",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return e.getDetails(t.row)}}},[e._v("详情")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return e.addTableName(t.row)}}},[e._v("新增表")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:function(a){return e.deleteRow(t.row)}}},[e._v("删除")])]}}])})],1)],1),e._v(" "),a("el-pagination",{staticStyle:{"text-align":"center",padding:"25px 0px"},attrs:{background:"",layout:"total, prev, pager, next","page-size":e.pageSize,total:e.allPage},on:{"current-change":e.tabPage}}),e._v(" "),a("el-dialog",{attrs:{title:"新增数据源",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-form",{ref:"dataSourceForm",attrs:{model:e.dataSourceForm,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"数据源类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择数据源类型"},model:{value:e.dataSourceForm.type,callback:function(t){e.$set(e.dataSourceForm,"type",t)},expression:"dataSourceForm.type"}},[a("el-option",{attrs:{label:"HBase",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"MBTiles",value:"2"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.dataSourceForm.name,callback:function(t){e.$set(e.dataSourceForm,"name",t)},expression:"dataSourceForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"地址",prop:"address"}},[a("el-input",{model:{value:e.dataSourceForm.address,callback:function(t){e.$set(e.dataSourceForm,"address",t)},expression:"dataSourceForm.address"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.onSubmit}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("取消")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"集群信息",visible:e.dialogTableVisible2},on:{"update:visible":function(t){e.dialogTableVisible2=t}}},[a("el-table",{staticStyle:{width:"100%","margin-top":"25px","border-left":"1px solid #e5e4e4"},attrs:{data:e.itemTable,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"name",label:"表名",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{prop:"comment",label:"备注信息"}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新增数据源表",visible:e.dialogTableVisible3},on:{"update:visible":function(t){e.dialogTableVisible3=t}}},[a("el-form",{ref:"tableForm",attrs:{model:e.tableForm,rules:e.tableRules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.tableForm.name,callback:function(t){e.$set(e.tableForm,"name",t)},expression:"tableForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注信息",prop:"comments"}},[a("el-input",{staticStyle:{width:"290px"},attrs:{type:"textarea"},model:{value:e.tableForm.comments,callback:function(t){e.$set(e.tableForm,"comments",t)},expression:"tableForm.comments"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.addNewTable}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogTableVisible3=!1}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var o=a("C7Lr")(i,r,!1,function(e){a("c58T")},"data-v-4f831c0f",null);t.default=o.exports},c58T:function(e,t){}});